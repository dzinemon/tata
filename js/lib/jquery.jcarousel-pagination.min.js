!function(e){"use strict";e.jCarousel.plugin("jcarouselPagination",{_options:{perPage:null,item:function(e){return'<a href="#'+e+'">'+e+"</a>"},event:"click",method:"scroll"},_carouselItems:null,_pages:{},_items:{},_currentPage:null,_init:function(){this.onDestroy=e.proxy(function(){this._destroy(),this.carousel().one("jcarousel:createend",e.proxy(this._create,this))},this),this.onReload=e.proxy(this._reload,this),this.onScroll=e.proxy(this._update,this)},_create:function(){this.carousel().one("jcarousel:destroy",this.onDestroy).on("jcarousel:reloadend",this.onReload).on("jcarousel:scrollend",this.onScroll),this._reload()},_destroy:function(){this._clear(),this.carousel().off("jcarousel:destroy",this.onDestroy).off("jcarousel:reloadend",this.onReload).off("jcarousel:scrollend",this.onScroll),this._carouselItems=null},_reload:function(){var t=this.options("perPage");if(this._pages={},this._items={},e.isFunction(t)&&(t=t.call(this)),null==t)this._pages=this._calculatePages();else for(var s,i=parseInt(t,10)||0,o=this._getCarouselItems(),r=1,a=0;0!==(s=o.eq(a++)).length;)this._pages[r]=this._pages[r]?this._pages[r].add(s):s,a%i==0&&r++;this._clear();var n=this,l=this.carousel().data("jcarousel"),c=this._element,u=this.options("item"),h=this._getCarouselItems().length;e.each(this._pages,function(t,s){var i=n._items[t]=e(u.call(n,t,s));i.on(n.options("event")+".jcarouselpagination",e.proxy(function(){var e=s.eq(0);if(l.circular){var i=l.index(l.target()),o=l.index(e);parseFloat(t)>parseFloat(n._currentPage)?i>o&&(e="+="+(h-i+o)):o>i&&(e="-="+(i+(h-o)))}l[this.options("method")](e)},n)),c.append(i)}),this._update()},_update:function(){var t,s=this.carousel().jcarousel("target");e.each(this._pages,function(e,i){return i.each(function(){return s.is(this)?(t=e,!1):void 0}),!t&&void 0}),this._currentPage!==t&&(this._trigger("inactive",this._items[this._currentPage]),this._trigger("active",this._items[t])),this._currentPage=t},items:function(){return this._items},reloadCarouselItems:function(){return this._carouselItems=null,this},_clear:function(){this._element.empty(),this._currentPage=null},_calculatePages:function(){for(var e,t,s=this.carousel().data("jcarousel"),i=this._getCarouselItems(),o=s.clipping(),r=0,a=0,n=1,l={};0!==(e=i.eq(a++)).length;)r+(t=s.dimension(e))>o&&(n++,r=0),r+=t,l[n]=l[n]?l[n].add(e):e;return l},_getCarouselItems:function(){return this._carouselItems||(this._carouselItems=this.carousel().jcarousel("items")),this._carouselItems}})}(jQuery);
